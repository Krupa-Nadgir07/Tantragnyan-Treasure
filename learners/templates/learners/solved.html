{% extends "learner.html" %} 
{% load crispy_forms_tags %}

{% block title %}Solved Questions{% endblock %}


{% block content %}
<div class="container py-2">
  <!-- Welcome Card with Pastel Gradient -->
  <div class="card mb-4 text-center">
  <div class="card-body d-flex align-items-center justify-content-center">
    <i class="bi bi-check-circle me-3 fs-1" style="color:black"></i>
    <h1 class="mb-0" style="color:rgb(0, 0, 0);">Look at your Hard Work! Lets keep Going!</h1>
  </div>
</div>

  {% if messages %}
    <div class="messages mb-4">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {% for platform, problems in platform_problems.items %}
    <div class="card mb-4 shadow-sm rounded-lg">
      <!-- Pastel Card Header -->
      <div class="card-header d-flex justify-content-between align-middle bg-primary">
        <h3 class="mb-0 fs-4 text-black">{{ platform }}</h3>
        <form method="POST" action="{% url 'sync_cp_account' platform=platform status="solved" %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-outline-dark btn-sm">
            <i class="bi bi-arrow-repeat me-2"></i>Sync {{ platform }}
          </button>
        </form>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle text-center">
            <thead class="table-light ">
              <tr>
                <th style="width: 10%;">S.No</th>
                <th style="width: 20%;">Problem Name</th>
                <th style="width: 15%;">Difficulty</th>
                <th style="width: 15%;">Action</th>
                <th style="width: 20%;">Bookmarked?</th>
              </tr>
            </thead>
            <tbody>
              {% for problem in problems %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ problem.problem_name }}</td>
                  <td>
                    <span class="badge difficulty-badge {% if problem.difficulty == 'Easy' %}easy{% elif problem.difficulty == 'Medium' %}medium{% else %}hard{% endif %}">
                      {{ problem.difficulty }}
                    </span>
                  </td>
                  <td>
                    <a href="{{ problem.problem_url }}" target="_blank" class="btn btn-outline-success btn-sm w-100">
                      <i class="bi bi-box-arrow-up-right me-1"></i>Open
                    </a>
                  </td>
                  <td>
                    <form method="post" action="{% url 'solved' %}" class="d-flex justify-content-center align-items-center" style="margin-bottom:2px">
                      {% csrf_token %}
                      <input type="hidden" name="problem_id" value="{{ problem.problem_id }}">
                      <button type="submit" class="btn btn-outline-secondary btn-sm">
                        {% if problem.bookmarked_status %}
                          <i class="bi bi-bookmark-dash me-1"></i>Remove
                        {% else %}
                          <i class="bi bi-bookmark-plus me-1"></i>Add
                        {% endif %}
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}
